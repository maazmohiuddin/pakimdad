---
layout: default
title: Name Search
---

{{> navbar-fade-account}}

<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required Meta Tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />

    <title>Pak-Imdaad</title>
    <link rel="icon" type="image/png" href="assets/img/favicon.png" />

    <!--Core CSS -->
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="assets/css/app.css" />
    <link rel="stylesheet" href="assets/css/core.css" />
  </head>
  <style>
    .profilepic {
      height: 50px;
      width: 50px;
      border-radius: 50%;
      border: 2px solid black;
    }
    .content table td {
      vertical-align: middle !important;
    }

    .circle {
      line-height: 0; /* remove line-height */
      display: inline-block; /* circle wraps image */
      margin: 5px;
      border: 1px solid rgba(200, 200, 200, 0.4);
      border-radius: 50%; /* relative value */
      /*box-shadow: 0px 0px 5px rgba(0,0,0,0.4);*/
      transition: linear 0.25s;
      object-fit: cover;
      object-position: center;
      height: 50px;
      width: 50px;
    }
    .circle img {
      border-radius: 50%; /* relative value for
  		   adjustable image size */
    }
    .circle:hover {
      transition: ease-out 0.2s;
      border: 4px solid rgba(0, 0, 0, 0.2);
      -webkit-transition: ease-out 0.2s;
    }
  </style>

  <body>
    <div class="pageloader"></div>
    <div class="infraloader is-active"></div>
    <!DOCTYPE html>
    <html lang="en">
      <body class="is-theme-core">
        <div class="<div" class="infraloader is-active"></div>

        <!-- Hero -->
        <!--Nav-->
        <div class="hero-body" style="background-color: rgb(245, 245, 245)">
          <div class="container">
            <div class="columns has-text-centered">
              <!-- Caption -->
              <div class="column is-8 is-offset-2 is-hero-caption is-centered">
                <h1 class="title is-1">Search Missing Person</h1>
                <h2
                  class="subtitle pt-10"
                  style="margin-bottom: 33px !important"
                >
                  Search through out community contributed database
                </h2>
                <div class="buttons">
                  <div class="grid-system is-medium">
                    <div class="column is-12">
                      <div class="flex-card simple-shadow">
                        <div class="card-body">
                          <div class="content">
                            <h2
                              class="no-margin title is-3"
                              style="margin-bottom: 33px !important"
                            >
                              Name Search
                            </h2>

                            <div class="columns is-vcentered pb-10">
                              <div class="column is-12">
                                <div class="section-wrapper">
                                  <div
                                    class="uploader-controls has-text-right animated preFadeInUp fadeInUp"
                                  >
                                    <div
                                      class="control-material is-primary has-icon"
                                    >
                                      <input
                                        class="material-input"
                                        type="text"
                                        required
                                        id="searchname"
                                      />
                                      <i class="material-icons pb-10">search</i>
                                      <span class="material-highlight"></span>
                                      <span class="bar"></span>
                                      <label>Name</label>
                                    </div>
                                    <button
                                      onClick="{searchbyname()}"
                                      type="button"
                                      class="button btn-align button-cta raised no-lh is-bold secondary-btn"
                                    >
                                      Search
                                    </button>
                                  </div>
                                  <table class="table">
                                    <thead>
                                      <tr>
                                        <th>Name</th>

                                        <th>Age</th>

                                        <th>Image</th>
                                        <th>Actions</th>
                                      </tr>
                                    </thead>

                                    <tbody id="data"></tbody>
                                  </table>
                                  <img
                                    class="is-centered is-vcentered"
                                    src="/assets/img/loader1.gif"
                                    style="
                                      width: 25%;
                                      display: none;
                                      margin-top: 50px;
                                    "
                                    loop="infinite"
                                    id="loader"
                                  />
                                </div>
                              </div>
                              <div class="column"></div>
                            </div>
                          </div>
                          <div id="errordiv" style="padding: 0% !important">
                            <p id="error" style="padding: 10px !important"></p>
                          </div>
                          <p class="body-color">
                            Search via Image in our database contributed by our
                            local social talent.
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- <div class="columns is-vcentered pt-30">
            <div class="column is-10 is-offset-1">
                <table class="table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Username</th>
                            <th>Email</th>
                            <th>Age</th>
                            <th>Contact</th>
                            <th>Image</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="data">

                    </tbody>
                </table>
            </div>
        </div> -->
        <!-- Card counter -->
        <div id="numbers-2" class="section section-feature-grey is-medium">
          <div class="container">
            <div class="section-title-wrapper">
              <div class="bg-number">1</div>
              <h2
                class="title section-title has-text-centered dark-text text-bold"
              >
                Hover cards
              </h2>
            </div>

            <div class="content-wrapper">
              <!-- Counters -->
              <div class="columns is-vcentered has-text-centered">
                <div class="column is-3">
                  <div class="card-counter">
                    <div class="flex-card light-bordered hover-inset">
                      <div class="round-icon">
                        <i class="material-icons">face</i>
                      </div>
                      <div class="counter counter-number text-bold">528</div>
                      <div class="counter-text">Active users</div>
                    </div>
                  </div>
                </div>
                <div class="column is-3">
                  <div class="card-counter">
                    <div class="flex-card light-bordered hover-inset">
                      <div class="round-icon">
                        <i class="material-icons">insert_drive_file</i>
                      </div>
                      <div class="counter counter-number text-bold">150000</div>
                      <div class="counter-text">Files shared</div>
                    </div>
                  </div>
                </div>
                <div class="column is-3">
                  <div class="card-counter">
                    <div class="flex-card light-bordered hover-inset">
                      <div class="round-icon">
                        <i class="material-icons">cloud_download</i>
                      </div>
                      <div class="counter counter-number text-bold">8924</div>
                      <div class="counter-text">Product downloads</div>
                    </div>
                  </div>
                </div>
                <div class="column is-3">
                  <div class="card-counter">
                    <div class="flex-card light-bordered hover-inset">
                      <div class="round-icon">
                        <i class="material-icons">attach_file</i>
                      </div>
                      <div class="counter counter-number text-bold">993</div>
                      <div class="counter-text">Attachments uploaded</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <button
          hidden
          id="triggerbut"
          class="modal-trigger"
          data-modal="card-modal3"
        ></button>

        <!-- Card modal -->
        <div id="card-modal3" class="modal modal-lg">
          <div class="modal-background"></div>
          <div class="modal-card modal-content z-index-101">
            <div class="modal-card-body" id="modal-data">
              <div class="container" id="moddiv"></div>
            </div>
            <footer class="modal-card-foot">
              <button class="button raised primary-btn modal-dismiss"  onclick="makeconversation()">
                
                Report
              </button>
              
              <button class="button raised primary-btn modal-dismiss" onclick="removerconversation()">
                Close
              </button>
            </footer>
          </div>
        </div>

        {{> footer-side-light}}

        <!-- Back To Top Button -->
        <div id="backtotop"><a href="#"></a></div>

        <!-- /Chat widget -->
        <script src="https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.js"></script>
        <script src="assets/js/app.js"></script>
        <script src="assets/js/core.js"></script>
      </body>
    </html>

    <!-- Back To Top Button -->
    <div id="backtotop"><a href="#"></a></div>
    <script src="assets/js/app.js"></script>
    <script src="assets/js/core.js"></script>
  </body>
  <script>
    const loader = document.getElementById("loader");
    function searchbyname() {
      loader.style.display = "";

      const name = document.getElementById("searchname").value;
      const res = fetch(
        `https://pakimdaad.herokuapp.com/api/query?first_name=${name}`,
        {
          method: "GET",
          headers: {
            authorization: `Bearer ${localStorage.getItem("token")}`,
          },
        }
      )
        .then((res) => res.json())
        .then((data) => {
          const tableBody = document.getElementById("data");
          const errordiv = document.getElementById("errordiv");
          
          tableBody.innerHTML = "";

          if (data.success) {
            const error = document.getElementById("error");
            error.setAttribute("class", "success");
            errordiv.setAttribute("class", "successclass");
            error.innerHTML = data.message;
            loader.style.display = "none";
            
            tableBody.innerHTML = "";
            for (var i = 0; i < data.data.length; i++) {
              const tr = document.createElement('tr');
              tr.className = 'rowddata';  
              tr.innerHTML = `<td>
                        ${
                          data.data[i].first_name + " " + data.data[i].last_name
                        }
                    </td>
                    <td>
    ${data.data[i].age}
    </td>
    <td>
        <img class="circle" src=https://pakimdaad.herokuapp.com/api/query/image/${
          data.data[i].images
        } class="profilepic">
    </td>
    <td>
      <button class="button is-small btn-align accent-btn raised rounded btn-outlined" onclick='datamap({
            "name": "${data.data[i].first_name} ${data.data[i].last_name}",
            "age": "${data.data[i].age}",
            "gender": "${data.data[i].gender}",
            "lastloc": "${data.data[i].lastLocation}",
            "datetime": "${data.data[i].dateTime}",
            "plantiff": "${data.data[i].plaintiff}",
            "email": "${data.data[i].email}",
            "contact": "${data.data[i].contact}",
            "altcontact": "${data.data[i].altContact}",
            "address": "${data.data[i].address}",
            "info": "${data.data[i].info}",
            "images": "${data.data[i].images}",
            "user_id":"${data.data[i].user_id}"

          })'>
            View More
          </button>
    </td>
    `;

              
    
    tableBody.appendChild(tr);
  }
          } else {
            const error = document.getElementById("error");
            error.setAttribute("class", "error");
            errordiv.setAttribute("class", "errorclass");
            error.innerHTML = data.message;
            loader.style.display = "none";
            console.log(data.message);
            markup = "";
            tableBody.insertAdjacentHTML("afterend", markup);
          }
        });
    }

    async function datamap(body) {
      
      // body = JSON.parse(body);

localStorage.setItem("receiverId",body.user_id)

      const datamodal = document.getElementById("moddiv");
      const fname = document.getElementById("fname");
      targetbutton = document.getElementById("triggerbut");
      targetbutton.click();

      let dataDiv = document.getElementById("moddiv");
      dataDiv.setAttribute("class", "data-div");

      dataDiv.innerHTML = `
            <p><strong>Name:</strong> ${body.name}</p>
            <p><strong>Age:</strong> ${body.age}</p>
            <p><strong>Gender:</strong> ${body.gender}</p>
            <p><strong>Last Location:</strong> ${body.lastloc}</p>
            <p><strong>Date/Time:</strong> ${body.datetime}</p>
            <p><strong>Plaintiff:</strong> ${body.plantiff}</p>
            <p><strong>Email:</strong> ${body.email}</p>
            <p><strong>Contact:</strong> ${body.contact}</p>
            <p><strong>Alt. Contact:</strong> ${body.altcontact}</p>
            <p><strong>Address:</strong> ${body.address}</p>
            <p><strong>Info:</strong> ${body.info}</p>
            <p><strong>Image:</strong> <img src="https://pakimdaad.herokuapp.com/api/query/image/${body.images}" class="modal-image"></p>
        `;
      datamodal.appendChild(dataDiv);
    }
  
  async function makeconversation(){
const receiverId= localStorage.getItem("receiverId")



const res = fetch(
  `http://localhost:5000/api/conversation`,
  {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      authorization: `Bearer ${localStorage.getItem("token")}`,
    },
    body:JSON.stringify({
      receiverId:receiverId
    })
  }
  
)
  .then((res) => res.json())
  .then((data) => {
  if(data.success){
    
    window.location.replace("http://localhost:3000/message.html")

  }
  })

  }
  async function removerconversation(){
    localStorage.setItem("receiverId",body.user_id)
  }
  </script>
</html>

<style>
  .successclass {
    color: #00ff3c;
    margin: 20px;
    padding: 10px;
    background-color: #afffc2;
    border-radius: 10px;
    border: 2px solid #7aff99;
  }

  .errorclass {
    color: #ff4570;
    margin: 20px;
    padding: 10px;
    background-color: #ffd8d8;
    border-radius: 10px;
    border: 2px solid #ff4570;

    /* background-color: #afffc2;
  border-radius: 10px;
  border: 2px solid #7aff99; */
  }
</style>
